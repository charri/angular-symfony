"use strict";function isValidDottedPath(r){return null!=r&&""!==r&&"hasOwnProperty"!==r&&MEMBER_NAME_REGEX.test("."+r)}function lookupDottedPath(r,e){if(!isValidDottedPath(e))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',e);for(var t=e.split("."),a=0,n=t.length;n>a&&void 0!==r;a++){var o=t[a];r=null!==r?r[o]:void 0}return r}function shallowClearAndCopy(r,e){e=e||{},angular.forEach(e,function(r,t){delete e[t]});for(var t in r)!r.hasOwnProperty(t)||"$"===t.charAt(0)&&"$"===t.charAt(1)||(e[t]=r[t]);return e}var $resourceMinErr=angular.$$minErr("$synfonyres"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;angular.module("symfony.resource",["ng"]).constant("jQuery",window.$).provider("$resource",function(){var r=this;this.defaults={stripTrailingSlashes:!0,params:{id:"@id"},actions:{get:{method:"GET"},save:{method:"POST"},update:{method:"PUT"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$q","jQuery",function(e,t,a){function n(r){return o(r,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function o(r,e){return encodeURIComponent(r).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,e?"%20":"+")}function s(e,t){this.template=e,this.defaults=l({},r.defaults,t),this.urlParams={}}function i(a,n,o,f){function h(r,e){var t={};return e=l({},n,e),c(e,function(e,a){d(e)&&(e=e()),t[a]=e&&e.charAt&&"@"==e.charAt(0)?lookupDottedPath(r,e.substr(1)):e}),t}function m(r){return r.resource}function g(r){shallowClearAndCopy(r||{},this)}f=l({},f);var $=new s(a,f);return o=l(!0,{},r.defaults.actions,o),n!==!1&&(n=l({},r.defaults.params,n)),g.prototype.toJSON=function(){var r=l({},this);return delete r.$promise,delete r.$resolved,r},c(o,function(r,a){var n=/^(POST|PUT|PATCH)$/i.test(r.method);g[a]=function(o,s,i,v){var E,y,w,A={};switch(arguments.length){case 4:w=v,y=i;case 3:case 2:if(!d(s)){A=o,E=s,y=i;break}if(d(o)){y=o,w=s;break}y=s,w=i;case 1:d(o)?y=o:n?E=o:A=o;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var P=this instanceof g,b=P?E:r.isArray?[]:new g(E),M={},T=r.interceptor&&r.interceptor.response||m,C=r.interceptor&&r.interceptor.responseError||void 0,D=r.nest||f.nest||void 0,R=t.defer();c(r,function(r,e){"params"!=e&&"isArray"!=e&&"interceptor"!=e&&(M[e]=p(r))}),n&&D?(M.data={},M.data[D]=E):n&&(M.data=E),$.setUrlParams(M,l({},h(E,r.params||{}),A),r.url);var O=function(e){var t=e.data,n=b.$promise;if(t){var o=D?t[D]:t;if(angular.isArray(o)!==!!r.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2}",a,r.isArray?"array":"object",angular.isArray(o)?"array":"object");r.isArray?(b.length=0,c(o,function(r){b.push("object"==typeof r?new g(r):r)})):(shallowClearAndCopy(o,b),b.$promise=n)}return b.$resolved=!0,e.resource=b,e},x=function(r){return b.$resolved=!0,(w||u)(r),R.reject(r)},j=function(r){var e=T(r);return(y||u)(e,r.headers),e},k=function(r){if(r){if(null==r.headers("Location")){var t=j(r);return R.resolve(t),t}var a=e.get(r.headers("Location"));a.then(O,x).then(k,C)}};return e(M).then(O,x).then(k,C),P?R.promise:(b.$promise=R,b.$resolved=!1,b)},g.prototype["$"+a]=function(r,e,t){d(r)&&(t=e,e=r,r={});var n=g[a].call(this,r,this,e,t);return n.$promise||n}}),g.bind=function(r){return i(a,l({},n,r),o)},g}var u=angular.noop,c=angular.forEach,l=a.extend,p=angular.copy,d=angular.isFunction;return s.prototype={setUrlParams:function(r,e,t){var a,o,s=this,i=t||s.template,u=s.urlParams={};c(i.split(/\W/),function(r){if("hasOwnProperty"===r)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(r)&&r&&new RegExp("(^|[^\\\\]):"+r+"(\\W|$)").test(i)&&(u[r]=!0)}),i=i.replace(/\\:/g,":"),e=e||{},c(s.urlParams,function(r,t){a=e.hasOwnProperty(t)?e[t]:s.defaults[t],angular.isDefined(a)&&null!==a?(o=n(a),i=i.replace(new RegExp(":"+t+"(\\W|$)","g"),function(r,e){return o+e})):i=i.replace(new RegExp("(/?):"+t+"(\\W|$)","g"),function(r,e,t){return"/"==t.charAt(0)?t:e+t})}),s.defaults.stripTrailingSlashes&&(i=i.replace(/\/+$/,"")||"/"),i=i.replace(/\/\.(?=\w+($|\?))/,"."),r.url=i.replace(/\/\\\./,"/."),c(e,function(e,t){s.urlParams[t]||(r.params=r.params||{},r.params[t]=e)})}},i}]});